{% extends 'xbtzmenarenapp/withMenu.html' %}

{% block content %}
  {% if ok_message %} 
    <div class="alert alert-success"> {{ ok_message }} </div>
  {% endif %}
  {% if error_message %} 
    <div class="alert alert-danger"> {{ error_message }} </div>
  {% endif %}
  <div class="container">
    <h1>Objednávka na nákup</h1>
    <ul class="nav nav-pills">
      {% if active == "btc" %}
        <li class="active" >
      {% else %}
        <li>
      {% endif %}
          <a data-toggle="pill" href="#Bitcoin">Bitcoin</a>
        </li>
      {% if active == "ltc" %}
        <li class="active" >
      {% else %}
        <li>
      {% endif %}
          <a data-toggle="pill" href="#Litecoin">Litecoin</a>
        </li>
      {% if active == "doge" %}
        <li class="active" >
      {% else %}
        <li>
      {% endif %}
          <a data-toggle="pill" href="#Dogecoin">Dogecoin</a>
        </li>
      {% if active == "eth" %}
        <li class="active" >
      {% else %}
        <li>
      {% endif %}
          <a data-toggle="pill" href="#Ethereum">Ethereum</a>
        </li>
      {% if active == "xlm" %}
        <li class="active" >
      {% else %}
        <li>
      {% endif %}
          <a data-toggle="pill" href="#Stellar">Stellar</a>
        </li>
      {% if active == "zrx" %}
        <li class="active" >
      {% else %}
        <li>
      {% endif %}
          <a data-toggle="pill" href="#0x">0x</a>
        </li>
    </ul>
    <div class="tab-content">

      {% if active == "btc" %}
      <div id="Bitcoin" class="tab-pane active">
      {% else %}
      <div id="Bitcoin" class="tab-pane">
      {% endif %}
        <form action="{% url 'limit-order-buy-btc' %}" method="post">
          {% csrf_token %}
          <div>Maximálna celková cena: <b id="max_sum_eur">{{ max_sum_eur }}</b> EUR</div>
          <div class="form-group">
            <label for="usr">Množstvo BTC:</label>
            <input id="sum_btc" type="text" class="form-control" name="sum_btc"/>
          </div>
          <div class="form-group">
            <label for="usr">Cena BTC-EUR:</label>
            <input id="price_btc" type="text" class="form-control" name="price_btc"/>
          </div>
          <div>Poplatky: <b id="fee_eur_btc">-</b> EUR</div>
          <div>Celková cena: <b id="sum_eur_btc">-</b> EUR</div>
          <button type="submit" class="btn btn-default">Objednať</button>
        </form>
        
        <table class="table">
          <thead>
              <tr>
                <td><b>BTC</b></td>
                <td><b>Cena</b></td>
                <td><b>Čas</b></td>
                <td><b>Zrušiť</b></td>
              </tr>
          </thead>
          <tbody>
            {% for order in orders_btc %}
              <tr>
                <td>{{ order.btc }}</td>
                <td>{{ order.price }}</td>
                <td>{{ order.datetime }}</td>
                <td>
                  <form action="{% url 'limit-order-buy-btc-delete' order.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-default">Zrušiť</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      {% if active == "ltc" %}
      <div id="Litecoin" class="tab-pane active">
      {% else %}
      <div id="Litecoin" class="tab-pane">
      {% endif %}
        <form action="{% url 'limit-order-buy-ltc' %}" method="post">
          {% csrf_token %}
          <div>Maximálna celková cena: <b id="max_sum_eur">{{ max_sum_eur }}</b> EUR</div>
          <div class="form-group">
            <label for="usr">Množstvo LTC:</label>
            <input id="sum_ltc" type="text" class="form-control" name="sum_ltc"/>
          </div>
          <div class="form-group">
            <label for="usr">Cena LTC-EUR:</label>
            <input id="price_ltc" type="text" class="form-control" name="price_ltc"/>
          </div>
          <div>Poplatky: <b id="fee_eur_ltc">-</b> EUR</div>
          <div>Celková cena: <b id="sum_eur_ltc">-</b> EUR</div>
          <button type="submit" class="btn btn-default">Objednať</button>
        </form>

        <table class="table">
          <thead>
              <tr>
                <td><b>LTC</b></td>
                <td><b>Cena</b></td>
                <td><b>Čas</b></td>
                <td><b>Zrušiť</b></td>
              </tr>
          </thead>
          <tbody>
            {% for order in orders_ltc %}
              <tr>
                <td>{{ order.ltc }}</td>
                <td>{{ order.price }}</td>
                <td>{{ order.datetime }}</td>
                <td>
                  <form action="{% url 'limit-order-buy-ltc-delete' order.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-default">Zrušiť</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      {% if active == "doge" %}
      <div id="Dogecoin" class="tab-pane active">
      {% else %}
      <div id="Dogecoin" class="tab-pane">
      {% endif %}
        <form action="{% url 'limit-order-buy-doge' %}" method="post">
          {% csrf_token %}
          <div>Maximálna celková cena: <b id="max_sum_eur">{{ max_sum_eur }}</b> EUR</div>
          <div class="form-group">
            <label for="usr">Množstvo DOGE:</label>
            <input id="sum_doge" type="text" class="form-control" name="sum_doge"/>
          </div>
          <div class="form-group">
            <label for="usr">Cena DOGE-EUR:</label>
            <input id="price_doge" type="text" class="form-control" name="price_doge"/>
          </div>
          <div>Poplatky: <b id="fee_eur_doge">-</b> EUR</div>
          <div>Celková cena: <b id="sum_eur_doge">-</b> EUR</div>
          <button type="submit" class="btn btn-default">Objednať</button>
        </form>

        <table class="table">
          <thead>
              <tr>
                <td><b>DOGE</b></td>
                <td><b>Cena</b></td>
                <td><b>Čas</b></td>
                <td><b>Zrušiť</b></td>
              </tr>
          </thead>
          <tbody>
            {% for order in orders_doge %}
              <tr>
                <td>{{ order.doge }}</td>
                <td>{{ order.price }}</td>
                <td>{{ order.datetime }}</td>
                <td>
                  <form action="{% url 'limit-order-buy-doge-delete' order.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-default">Zrušiť</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      {% if active == "eth" %}
      <div id="Ethereum" class="tab-pane active">
      {% else %}
      <div id="Ethereum" class="tab-pane">
      {% endif %}
        <form action="{% url 'limit-order-buy-eth' %}" method="post">
          {% csrf_token %}
          <div>Maximálna celková cena: <b id="max_sum_eur">{{ max_sum_eur }}</b> EUR</div>
          <div class="form-group">
            <label for="usr">Množstvo ETH:</label>
            <input id="sum_eth" type="text" class="form-control" name="sum_eth"/>
          </div>
          <div class="form-group">
            <label for="usr">Cena ETH-EUR:</label>
            <input id="price_eth" type="text" class="form-control" name="price_eth"/>
          </div>
          <div>Poplatky: <b id="fee_eur_eth">-</b> EUR</div>
          <div>Celková cena: <b id="sum_eur_eth">-</b> EUR</div>
          <button type="submit" class="btn btn-default">Objednať</button>
        </form>

        <table class="table">
          <thead>
              <tr>
                <td><b>ETH</b></td>
                <td><b>Cena</b></td>
                <td><b>Čas</b></td>
                <td><b>Zrušiť</b></td>
              </tr>
          </thead>
          <tbody>
            {% for order in orders_eth %}
              <tr>
                <td>{{ order.eth }}</td>
                <td>{{ order.price }}</td>
                <td>{{ order.datetime }}</td>
                <td>
                  <form action="{% url 'limit-order-buy-eth-delete' order.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-default">Zrušiť</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      {% if active == "xlm" %}
      <div id="Stellar" class="tab-pane active">
      {% else %}
      <div id="Stellar" class="tab-pane">
      {% endif %}
        <form action="{% url 'limit-order-buy-xlm' %}" method="post">
          {% csrf_token %}
          <div>Maximálna celková cena: <b id="max_sum_eur">{{ max_sum_eur }}</b> EUR</div>
          <div class="form-group">
            <label for="usr">Množstvo XLM:</label>
            <input id="sum_xlm" type="text" class="form-control" name="sum_xlm"/>
          </div>
          <div class="form-group">
            <label for="usr">Cena XLM-EUR:</label>
            <input id="price_xlm" type="text" class="form-control" name="price_xlm"/>
          </div>
          <div>Poplatky: <b id="fee_eur_xlm">-</b> EUR</div>
          <div>Celková cena: <b id="sum_eur_xlm">-</b> EUR</div>
          <button type="submit" class="btn btn-default">Objednať</button>
        </form>

        <table class="table">
          <thead>
              <tr>
                <td><b>XLM</b></td>
                <td><b>Cena</b></td>
                <td><b>Čas</b></td>
                <td><b>Zrušiť</b></td>
              </tr>
          </thead>
          <tbody>
            {% for order in orders_xlm %}
              <tr>
                <td>{{ order.xlm }}</td>
                <td>{{ order.price }}</td>
                <td>{{ order.datetime }}</td>
                <td>
                  <form action="{% url 'limit-order-buy-xlm-delete' order.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-default">Zrušiť</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

    </div>
  </div>
  <script>
    function onChangeBtc() {
      if(isNaN($('#sum_btc').val()) 
        || $('#sum_btc').val() == ""
        || $('#sum_btc').val() == 0
        || isNaN($('#price_btc').val()) 
        || $('#price_btc').val() == ""
        || $('#price_btc').val() == 0)
      {
        $('#fee_eur_btc').text("-");
        $('#sum_eur_btc').text("-");
      } else {
        $.post("{% url 'limit-order-buy-btc-json' %}",
          { 
            sum_btc: $('#sum_btc').val(),
            price_btc: $('#price_btc').val(),
            csrfmiddlewaretoken: '{{ csrf_token }}'
          },
          function(data) {
            $('#fee_eur_btc').text(data.fee);
            $('#sum_eur_btc').text(data.eur);
          }
        );
      }
    }
    $('#sum_btc').on("change paste keyup", onChangeBtc);
    $('#price_btc').on("change paste keyup", onChangeBtc);

    function onChangeLtc() {
      if(isNaN($('#sum_ltc').val()) 
        || $('#sum_ltc').val() == ""
        || $('#sum_ltc').val() == 0
        || isNaN($('#price_ltc').val()) 
        || $('#price_ltc').val() == ""
        || $('#price_ltc').val() == 0)
      {
        $('#fee_eur_ltc').text("-");
        $('#sum_eur_ltc').text("-");
      } else {
        $.post("{% url 'limit-order-buy-ltc-json' %}",
          { 
            sum_ltc: $('#sum_ltc').val(),
            price_ltc: $('#price_ltc').val(),
            csrfmiddlewaretoken: '{{ csrf_token }}'
          },
          function(data) {
            $('#fee_eur_ltc').text(data.fee);
            $('#sum_eur_ltc').text(data.eur);
          }
        );
      }
    }
    $('#sum_ltc').on("change paste keyup", onChangeLtc);
    $('#price_ltc').on("change paste keyup", onChangeLtc);

    function onChangeDoge() {
      if(isNaN($('#sum_doge').val()) 
        || $('#sum_doge').val() == ""
        || $('#sum_doge').val() == 0
        || isNaN($('#price_doge').val()) 
        || $('#price_doge').val() == ""
        || $('#price_doge').val() == 0)
      {
        $('#fee_eur_doge').text("-");
        $('#sum_eur_doge').text("-");
      } else {
        $.post("{% url 'limit-order-buy-doge-json' %}",
          { 
            sum_doge: $('#sum_doge').val(),
            price_doge: $('#price_doge').val(),
            csrfmiddlewaretoken: '{{ csrf_token }}'
          },
          function(data) {
            $('#fee_eur_doge').text(data.fee);
            $('#sum_eur_doge').text(data.eur);
          }
        );
      }
    }
    $('#sum_doge').on("change paste keyup", onChangeDoge);
    $('#price_doge').on("change paste keyup", onChangeDoge);

    function onChangeEth() {
      if(isNaN($('#sum_eth').val()) 
        || $('#sum_eth').val() == ""
        || $('#sum_eth').val() == 0
        || isNaN($('#price_eth').val()) 
        || $('#price_eth').val() == ""
        || $('#price_eth').val() == 0)
      {
        $('#fee_eur_eth').text("-");
        $('#sum_eur_eth').text("-");
      } else {
        $.post("{% url 'limit-order-buy-eth-json' %}",
          { 
            sum_eth: $('#sum_eth').val(),
            price_eth: $('#price_eth').val(),
            csrfmiddlewaretoken: '{{ csrf_token }}'
          },
          function(data) {
            $('#fee_eur_eth').text(data.fee);
            $('#sum_eur_eth').text(data.eur);
          }
        );
      }
    }
    $('#sum_eth').on("change paste keyup", onChangeEth);
    $('#price_eth').on("change paste keyup", onChangeEth);

    function onChangeXlm() {
      if(isNaN($('#sum_xlm').val()) 
        || $('#sum_xlm').val() == ""
        || $('#sum_xlm').val() == 0
        || isNaN($('#price_xlm').val()) 
        || $('#price_xlm').val() == ""
        || $('#price_xlm').val() == 0)
      {
        $('#fee_eur_xlm').text("-");
        $('#sum_eur_xlm').text("-");
      } else {
        $.post("{% url 'limit-order-buy-xlm-json' %}",
          { 
            sum_xlm: $('#sum_xlm').val(),
            price_xlm: $('#price_xlm').val(),
            csrfmiddlewaretoken: '{{ csrf_token }}'
          },
          function(data) {
            $('#fee_eur_xlm').text(data.fee);
            $('#sum_eur_xlm').text(data.eur);
          }
        );
      }
    }
    $('#sum_xlm').on("change paste keyup", onChangeXlm);
    $('#price_xlm').on("change paste keyup", onChangeXlm);

    function onChangeZrx() {
      if(isNaN($('#sum_zrx').val()) 
        || $('#sum_zrx').val() == ""
        || $('#sum_zrx').val() == 0
        || isNaN($('#price_zrx').val()) 
        || $('#price_zrx').val() == ""
        || $('#price_zrx').val() == 0)
      {
        $('#fee_eur_zrx').text("-");
        $('#sum_eur_zrx').text("-");
      } else {
        $.post("{% url 'limit-order-buy-zrx-json' %}",
          { 
            sum_zrx: $('#sum_zrx').val(),
            price_zrx: $('#price_zrx').val(),
            csrfmiddlewaretoken: '{{ csrf_token }}'
          },
          function(data) {
            $('#fee_eur_zrx').text(data.fee);
            $('#sum_eur_zrx').text(data.eur);
          }
        );
      }
    }
    $('#sum_zrx').on("change paste keyup", onChangeZrx);
    $('#price_zrx').on("change paste keyup", onChangeZrx);
  </script>
{% endblock %}
